// ReMnBWarband 编辑器主界面

import { AppBridge, UiState, WindowControlBridge } from "globals/bridges.slint";
import { Styles } from "globals/styles.slint";

export { AppBridge, UiState, WindowControlBridge }

// 核心数据结构
export struct GameInstance {
    id: string,
    name: string,
    path: string,
    version: string,
    status: string,
}

// 主窗口组件
export component MainWindow inherits Window {
    title: "ReMnBWarband 编辑器";
    width: 1200px;
    height: 800px;
    
    property <bool> _ensure_globals: AppBridge.game-detected && UiState.current-page >= 0;
    
    VerticalLayout {
        Text {
            text: "ReMnBWarband 编辑器 - " + AppBridge.status-message;
            font-size: 24px;
            horizontal-alignment: center;
        }
        
        Rectangle {
            height: 50px;
            HorizontalLayout {
                Rectangle {
                    width: 120px;
                    height: 40px;
                    background: #4CAF50;
                    border-radius: 4px;
                    
                    TouchArea {
                        clicked => {
                            AppBridge.detect-game();
                        }
                    }
                    
                    Text {
                        text: "检测游戏";
                        color: white;
                        horizontal-alignment: center;
                        vertical-alignment: center;
                    }
                }
                
                Rectangle {
                    width: 120px;
                    height: 40px;
                    background: #2196F3;
                    border-radius: 4px;
                    
                    TouchArea {
                        clicked => {
                            AppBridge.browse-game-path();
                        }
                    }
                    
                    Text {
                        text: "浏览路径";
                        color: white;
                        horizontal-alignment: center;
                        vertical-alignment: center;
                    }
                }
                
                Rectangle {
                    width: 120px;
                    height: 40px;
                    background: #FF9800;
                    border-radius: 4px;
                    
                    TouchArea {
                        clicked => {
                            AppBridge.enter-editor();
                        }
                    }
                    
                    Text {
                        text: "进入编辑器";
                        color: white;
                        horizontal-alignment: center;
                        vertical-alignment: center;
                    }
                }
            }
        }
        
        Text {
            text: "游戏路径: " + AppBridge.game-path;
            font-size: 14px;
        }
        
        if AppBridge.error-message != "" : Text {
            text: "错误: " + AppBridge.error-message;
            color: red;
        }
    }
}
