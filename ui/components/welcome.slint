import { Button, VerticalBox, HorizontalBox, ListView, ComboBox, LineEdit, GroupBox, ScrollView } from "std-widgets.slint";

// æ¬¢è¿ç•Œé¢ç»„ä»¶
export component WelcomeScreen inherits Rectangle {
    // å›è°ƒå‡½æ•°
    callback detect_games() -> [string];
    callback select_game(int);
    callback browse_game_folder() -> string;
    callback continue_to_editor();
    callback show_about();
    
    // çŠ¶æ€å±æ€§
    in property <[string]> detected_games;
    in property <string> detection_status: "æ£€æµ‹ä¸­...";
    in property <int> selected_game_index: -1;
    in property <string> warband_version: "æœªçŸ¥ç‰ˆæœ¬";
    
    background: #f0f0f0;
    
    VerticalLayout {
        padding: 40px;
        spacing: 24px;
        
        // é¡¶éƒ¨æ ‡é¢˜åŒºåŸŸ
        Rectangle {
            height: 80px;
            background: white;
            border-width: 1px;
            border-color: #d0d0d0;
            
            VerticalLayout {
                padding: 16px;
                spacing: 4px;
                
                Text {
                    text: "Rçƒç¼–è¾‘å™¨";
                    font-size: 24px;
                    font-weight: 600;
                    color: #333;
                    horizontal-alignment: center;
                }
                
                Text {
                    text: "éª‘é©¬ä¸ç æ€æˆ˜å›¢æ¨¡ç»„ç¼–è¾‘å™¨";
                    font-size: 13px;
                    color: #666;
                    horizontal-alignment: center;
                }
            }
        }
        
        // ä¸»è¦å†…å®¹åŒºåŸŸ
        HorizontalLayout {
            spacing: 24px;
            
            // å·¦ä¾§æ¸¸æˆæ£€æµ‹åŒºåŸŸ
            Rectangle {
                width: 400px;
                background: white;
                border-width: 1px;
                border-color: #d0d0d0;
                
                VerticalLayout {
                    padding: 20px;
                    spacing: 16px;
                    
                    Text {
                        text: "æ¸¸æˆæ£€æµ‹";
                        font-size: 16px;
                        font-weight: 600;
                        color: #333;
                    }
                    
                    Rectangle {
                        height: 1px;
                        background: #e0e0e0;
                    }
                    
                    VerticalLayout {
                        spacing: 12px;
                        
                        HorizontalLayout {
                            spacing: 8px;
                            
                            Button {
                                text: "æ£€æµ‹æ¸¸æˆ";
                                width: 80px;
                                height: 28px;
                                clicked => { root.detect_games(); }
                            }
                            
                            Button {
                                text: "æµè§ˆæ–‡ä»¶å¤¹";
                                width: 90px;
                                height: 28px;
                                clicked => { root.browse_game_folder(); }
                            }
                        }
                        
                        Text {
                            text: detection_status;
                            font-size: 12px;
                            color: #666;
                        }
                        
                        if detected_games.length > 0: GroupBox {
                            title: "æ£€æµ‹åˆ°çš„æ¸¸æˆ";
                            
                            VerticalLayout {
                                spacing: 8px;
                                
                                ListView {
                                    height: 120px;
                                    for game[index] in detected_games: Rectangle {
                                        height: 24px;
                                        background: selected_game_index == index ? #e3f2fd : transparent;
                                        border-width: selected_game_index == index ? 1px : 0px;
                                        border-color: #2196f3;
                                        
                                        HorizontalLayout {
                                            padding-left: 8px;
                                            padding-right: 8px;
                                            padding-top: 4px;
                                            padding-bottom: 4px;
                                            
                                            Text {
                                                text: game;
                                                font-size: 12px;
                                                color: #333;
                                                vertical-alignment: center;
                                            }
                                        }
                                        
                                        TouchArea {
                                            clicked => { root.select_game(index); }
                                        }
                                    }
                                }
                                
                                if selected_game_index >= 0: Text {
                                    text: "ç‰ˆæœ¬: " + warband_version;
                                    font-size: 12px;
                                    color: #666;
                                }
                            }
                        }
                    }
                }
            }
            
            // å³ä¾§åŠŸèƒ½ä»‹ç»åŒºåŸŸ
            Rectangle {
                background: white;
                border-width: 1px;
                border-color: #d0d0d0;
                
                VerticalLayout {
                    padding: 20px;
                    spacing: 16px;
                    
                    Text {
                        text: "åŠŸèƒ½ç‰¹æ€§";
                        font-size: 16px;
                        font-weight: 600;
                        color: #333;
                    }
                    
                    Rectangle {
                        height: 1px;
                        background: #e0e0e0;
                    }
                    
                    VerticalLayout {
                        spacing: 12px;
                        
                        HorizontalLayout {
                            spacing: 8px;
                            
                            Text {
                                text: "ğŸ“¦";
                                font-size: 16px;
                                width: 24px;
                            }
                            
                            Text {
                                text: "ç‰©å“ç¼–è¾‘å™¨ - ç¼–è¾‘æ­¦å™¨ã€è£…å¤‡å±æ€§";
                                font-size: 13px;
                                color: #333;
                                vertical-alignment: center;
                            }
                        }
                        
                        HorizontalLayout {
                            spacing: 8px;
                            
                            Text {
                                text: "âš”ï¸";
                                font-size: 16px;
                                width: 24px;
                            }
                            
                            Text {
                                text: "å…µç§ç¼–è¾‘å™¨ - ç®¡ç†å…µç§æ•°æ®";
                                font-size: 13px;
                                color: #333;
                                vertical-alignment: center;
                            }
                        }
                        
                        HorizontalLayout {
                            spacing: 8px;
                            
                            Text {
                                text: "âš¡";
                                font-size: 16px;
                                width: 24px;
                            }
                            
                            Text {
                                text: "è§¦å‘å™¨ç¼–è¾‘å™¨ - è„šæœ¬é€»è¾‘ç¼–è¾‘";
                                font-size: 13px;
                                color: #333;
                                vertical-alignment: center;
                            }
                        }
                        
                        HorizontalLayout {
                            spacing: 8px;
                            
                            Text {
                                text: "ğŸ";
                                font-size: 16px;
                                width: 24px;
                            }
                            
                            Text {
                                text: "Pythonè„šæœ¬ - è‡ªå®šä¹‰è„šæœ¬æ‰§è¡Œ";
                                font-size: 13px;
                                color: #333;
                                vertical-alignment: center;
                            }
                        }
                    }
                }
            }
        }
        
        // åº•éƒ¨æ“ä½œåŒºåŸŸ
        Rectangle {
            height: 60px;
            background: white;
            border-width: 1px;
            border-color: #d0d0d0;
            
            HorizontalLayout {
                padding: 16px;
                spacing: 12px;
                
                Rectangle { }
                
                Button {
                    text: "å…³äº";
                    width: 60px;
                    height: 28px;
                    clicked => { root.show_about(); }
                }
                
                Button {
                    text: "è¿›å…¥ç¼–è¾‘å™¨";
                    width: 90px;
                    height: 28px;
                    enabled: selected_game_index >= 0;
                    clicked => { root.continue_to_editor(); }
                }
            }
        }
    }
}
