import { Button, VerticalBox, HorizontalBox, ListView, ComboBox, LineEdit, GroupBox, ScrollView } from "std-widgets.slint";

// 欢迎界面组件
export component WelcomeScreen inherits Rectangle {
    // 回调函数
    callback detect_games() -> [string];
    callback select_game(int);
    callback browse_game_folder() -> string;
    callback continue_to_editor();
    callback show_about();
    
    // 状态属性
    in property <[string]> detected_games;
    in property <string> detection_status: "检测中...";
    in property <int> selected_game_index: -1;
    in property <string> warband_version: "未知版本";
    
    background: #f0f0f0;
    
    VerticalLayout {
        padding: 40px;
        spacing: 24px;
        
        // 顶部标题区域
        Rectangle {
            height: 80px;
            background: white;
            border-width: 1px;
            border-color: #d0d0d0;
            
            VerticalLayout {
                padding: 16px;
                spacing: 4px;
                
                Text {
                    text: "R球编辑器";
                    font-size: 24px;
                    font-weight: 600;
                    color: #333;
                    horizontal-alignment: center;
                }
                
                Text {
                    text: "骑马与砍杀战团模组编辑器";
                    font-size: 13px;
                    color: #666;
                    horizontal-alignment: center;
                }
            }
        }
        
        // 主要内容区域
        HorizontalLayout {
            spacing: 24px;
            
            // 左侧游戏检测区域
            Rectangle {
                width: 400px;
                background: white;
                border-width: 1px;
                border-color: #d0d0d0;
                
                VerticalLayout {
                    padding: 20px;
                    spacing: 16px;
                    
                    Text {
                        text: "游戏检测";
                        font-size: 16px;
                        font-weight: 600;
                        color: #333;
                    }
                    
                    Rectangle {
                        height: 1px;
                        background: #e0e0e0;
                    }
                    
                    VerticalLayout {
                        spacing: 12px;
                        
                        HorizontalLayout {
                            spacing: 8px;
                            
                            Button {
                                text: "检测游戏";
                                width: 80px;
                                height: 28px;
                                clicked => { root.detect_games(); }
                            }
                            
                            Button {
                                text: "浏览文件夹";
                                width: 90px;
                                height: 28px;
                                clicked => { root.browse_game_folder(); }
                            }
                        }
                        
                        Text {
                            text: detection_status;
                            font-size: 12px;
                            color: #666;
                        }
                        
                        if detected_games.length > 0: GroupBox {
                            title: "检测到的游戏";
                            
                            VerticalLayout {
                                spacing: 8px;
                                
                                ListView {
                                    height: 120px;
                                    for game[index] in detected_games: Rectangle {
                                        height: 24px;
                                        background: selected_game_index == index ? #e3f2fd : transparent;
                                        border-width: selected_game_index == index ? 1px : 0px;
                                        border-color: #2196f3;
                                        
                                        HorizontalLayout {
                                            padding-left: 8px;
                                            padding-right: 8px;
                                            padding-top: 4px;
                                            padding-bottom: 4px;
                                            
                                            Text {
                                                text: game;
                                                font-size: 12px;
                                                color: #333;
                                                vertical-alignment: center;
                                            }
                                        }
                                        
                                        TouchArea {
                                            clicked => { root.select_game(index); }
                                        }
                                    }
                                }
                                
                                if selected_game_index >= 0: Text {
                                    text: "版本: " + warband_version;
                                    font-size: 12px;
                                    color: #666;
                                }
                            }
                        }
                    }
                }
            }
            
            // 右侧功能介绍区域
            Rectangle {
                background: white;
                border-width: 1px;
                border-color: #d0d0d0;
                
                VerticalLayout {
                    padding: 20px;
                    spacing: 16px;
                    
                    Text {
                        text: "功能特性";
                        font-size: 16px;
                        font-weight: 600;
                        color: #333;
                    }
                    
                    Rectangle {
                        height: 1px;
                        background: #e0e0e0;
                    }
                    
                    VerticalLayout {
                        spacing: 12px;
                        
                        HorizontalLayout {
                            spacing: 8px;
                            
                            Text {
                                text: "📦";
                                font-size: 16px;
                                width: 24px;
                            }
                            
                            Text {
                                text: "物品编辑器 - 编辑武器、装备属性";
                                font-size: 13px;
                                color: #333;
                                vertical-alignment: center;
                            }
                        }
                        
                        HorizontalLayout {
                            spacing: 8px;
                            
                            Text {
                                text: "⚔️";
                                font-size: 16px;
                                width: 24px;
                            }
                            
                            Text {
                                text: "兵种编辑器 - 管理兵种数据";
                                font-size: 13px;
                                color: #333;
                                vertical-alignment: center;
                            }
                        }
                        
                        HorizontalLayout {
                            spacing: 8px;
                            
                            Text {
                                text: "⚡";
                                font-size: 16px;
                                width: 24px;
                            }
                            
                            Text {
                                text: "触发器编辑器 - 脚本逻辑编辑";
                                font-size: 13px;
                                color: #333;
                                vertical-alignment: center;
                            }
                        }
                        
                        HorizontalLayout {
                            spacing: 8px;
                            
                            Text {
                                text: "🐍";
                                font-size: 16px;
                                width: 24px;
                            }
                            
                            Text {
                                text: "Python脚本 - 自定义脚本执行";
                                font-size: 13px;
                                color: #333;
                                vertical-alignment: center;
                            }
                        }
                    }
                }
            }
        }
        
        // 底部操作区域
        Rectangle {
            height: 60px;
            background: white;
            border-width: 1px;
            border-color: #d0d0d0;
            
            HorizontalLayout {
                padding: 16px;
                spacing: 12px;
                
                Rectangle { }
                
                Button {
                    text: "关于";
                    width: 60px;
                    height: 28px;
                    clicked => { root.show_about(); }
                }
                
                Button {
                    text: "进入编辑器";
                    width: 90px;
                    height: 28px;
                    enabled: selected_game_index >= 0;
                    clicked => { root.continue_to_editor(); }
                }
            }
        }
    }
}
